<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Product Page</title>
  <link rel="stylesheet" href="base.css">
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="product.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" />
  <script type="module" src="navbar.js"></script>
  <script src="data.js"></script>
  <script type="module" src="script.js" defer></script>
</head>
<body>

  <header class="navbar">
    <div class="nav-left">
      <a href="index.html" class="logo">
        <img src="DEADSTOCK (3).png" alt="DeadstockBlvd Logo" class="logo-img" />
      </a>

      <div class="nav-wrapper" id="navWrapper">
        <nav id="navbar">
          <i id="close" class="fas fa-times"></i>
          <a href="index.html">Home</a>
          <a href="shop.html" class="active">Shop</a>
          <a href="Contact.html">Contact</a>
        </nav>
      </div>
      <img id="bar" src="Hamburger.png" alt="Menu" class="hamburger-icon" />
    </div>

    <div class="nav-right">
      <button id="searchIcon" class="icon-button">
        <img src="SearchIcon.png" alt="Search" class="search-icon" />
      </button>
      <button id="cartIcon" class="cart-wrapper icon-button">
        <img src="CartIcon.png" alt="Cart" class="cart-icon" />
        <span id="cart-count">0</span>
      </button>
    </div>
  </header>

  <div id="preloader">
    <div class="loader">Loading...</div>
  </div>

  <!-- ✅ Search Bar Container (below navbar) -->
  <div id="searchBarContainer">
    <div class="search-input-wrapper">
      <input
        type="text"
        id="searchInput"
        placeholder="Search products..."
        autocomplete="off"
      />
      <button id="clearSearch" aria-label="Clear Search">&times;</button>
    </div>
        
    <!-- ✅ Shared scroll wrapper for both -->
      <div id="searchScrollableArea">
          <ul id="searchSuggestions" class="search-suggestions"></ul>
            
          <div id="searchResultsWrapper">
              <p id="noResultsMessage" style="display: none;">No products found.</p>
              <div id="searchResults"></div>
          </div>
      </div>
  </div>
    
  <!-- ✅ Search overlay now OUTSIDE the container -->
  <div id="searchOverlay"></div>

  <main class="product-page">
    <div class="product-container">
      
      <div class="product-gallery">
        <div class="slider">
          <i class="fas fa-chevron-left nav-arrow" id="prevSlide"></i>
          
          <div class="main-img-wrapper">
            <img id="mainImage" src="Nike Sweatpants (4).png" alt="Product Image" class="main-img" />
          </div>
          
          <i class="fas fa-chevron-right nav-arrow" id="nextSlide"></i>
          
          <div class="mobile-dots"></div> 
        </div>
        <div class="thumbnails">
          <img src="Nike Sweatpants (3).png" class="thumb" />
          <img src="Nike Sweatpants (4).png" class="thumb" />
          <img src="Nike Sweatpants (2).png" class="thumb" />
          <img src="Nike Sweatpants (1).png" class="thumb" />
        </div>
      </div>

      <div class="product-info">
        <h5>
          Nike
        </h5>
        <h4>
          Nike Sweatpants
        </h4>
        
        <p class="price converted-price" id="convertedPrice" data-gbp="20.00">£20.00</p><!-- use GBP by default -->
        
        <p class="description">
          Size:  M
        </p>
        <p class="description">
          Condition:  Gently used
          <br><br> 
          Visible signs of wear would be shown above. 
          If you have any additional questions about a specific item please email us directly....
          <span class="read-more">Read more</span>
        </p>
        <button
          id="addToCartBtn"
          class="add-to-cart"
          data-id="7"
          data-name="Nike Sweatpants"
          data-price="20"
          data-image="Nike Sweatpants (4).png">
          Add to Cart 🛒
        </button>
        <!-- PayFast Demo Button -->
        <form action="https://sandbox.payfast.co.za/eng/process" method="POST" id="payfastFormDemo">
          <input type="hidden" name="merchant_id" value="10041066" />
          <input type="hidden" name="merchant_key" value="itdun3pbyglz7" />
          
          <input type="hidden" name="return_url" value="https://sbrixton.github.io/DeadstockBlvd/success.html" />
          <input type="hidden" name="cancel_url" value="https://deadstockblvd.co.za/cancel.html" />
          <input type="hidden" name="notify_url" value="https://deadstockblvd.wuaze.com/basic%20notify.php" />
          
          <input type="hidden" name="m_payment_id" value="1234" />
          <input type="hidden" name="amount" id="pfAmount" data-base-price="20.00" value="20.00" />
          <input type="hidden" name="currency" value="ZAR" />
          <input type="hidden" name="item_name" id="pfItemName" value="Nike Sweatpants" />
          
          <button type="submit" class="payfast-btn">Pay with PayFast (Demo)</button>
        </form>
      </div>
    </div>
        <!-- This goes AFTER .product-container -->
        <div class="recommendation-wrapper">
          <h3 class="recommendation-title">YOU MAY ALSO LIKE</h3>
          <div class="recommendations-grid">
            
            <!-- Product Card 1 -->
            <div class="pro">
                <a href="product2.html" class="pro-link">
                    <div class="product-img">
                        <img src="Nike x CRTZ  (1).png" alt="Main" class="main-img" />
                        <img src="Nike x CRTZ  (3).png" alt="Hover" class="hover-img" />
                    </div>
                    <div class="des">
                        <h5>Nike x Corteiz Air Max 95</h5>
                        <h4 class="converted-price" data-gbp="98">£98.00</h4>
                    </div>
                </a>
                <button 
                    class="add-to-cart-btn"
                    data-name="Nike x Corteiz Air Max 95"
                    data-price="98"
                    data-image="Nike x CRTZ  (3).png"
                    data-id="2">
                    <img src="CartIcon.png" alt="Add to cart" class="btn-icon" />
                </button>
            </div>
            
            <!-- Product Card 2 -->
            <div class="pro">
                <a href="product4.html" class="pro-link">
                    <div class="product-img">
                        <img src="Balenciaga Track Pants (2).png" alt="Main" class="main-img" />
                        <img src="Balenciaga Track Pants (4).png" alt="Hover" class="hover-img" />
                    </div>
                    <div class="des">
                        <h5>Balenciaga Track Pants</h5>
                        <h4 class="converted-price" data-gbp="96">£96.00</h4>
                    </div>
                </a>
                <button 
                    class="add-to-cart-btn"
                    data-name="Balenciage Track Pants"
                    data-price="96"
                    data-image="Balenciaga Track Pants (2).png"
                    data-id="4">
                    <img src="CartIcon.png" alt="Add to cart" class="btn-icon" />
                </button>
            </div>
            
            <div class="pro">
                <a href="product1.html" class="pro-link">
                    <div class="product-img">
                      <img src="Nike SB Dunk Orange Grateful Dead (1).png" alt="Main" class="main-img" />
                      <img src="Nike SB Dunk Orange Grateful Dead (4).png" alt="Hover" class="hover-img" />
                    </div>
                    <div class="des">
                      <h5>Nike SB Dunk</h5>
                      <h4 class="converted-price" data-gbp="86">£86.00</h4>
                    </div>
                </a>
                
                <!-- ✅ New Add-to-Cart Button -->
                <button 
                    class="add-to-cart-btn"
                    data-name="Nike SB Dunk <br> Orange Grateful Dead "
                    data-price="86"
                    data-image="Nike SB Dunk Orange Grateful Dead (1).png"
                    data-id="1">
                    <img src="CartIcon.png" alt="Add to cart" class="btn-icon" />
                </button>
            </div>
            
            <div class="pro">
                <a href="product5.html" class="pro-link">
                    <div class="product-img">
                        <img src="Nike Air Max 95 OG Mandarin-2 (5).png" alt="Main Image" class="main-img" />
                        <img src="Nike Air Max 95 OG Mandarin-2 (3).png" alt="Hover Image" class="hover-img" /> 
                    </div>
                    <div class="des">
                        <h5>Nike Air Max 95 OG Mandarin</h5>
                        <h4 class="converted-price" data-gbp="76">£76.00</h4>
                    </div>
                </a>
                <button 
                    class="add-to-cart-btn"
                    data-name="Nike Air Max 95 <br> OG Mandarin"
                    data-price="76"
                    data-image="Nike Air Max 95 OG Mandarin-2 (5).png"
                    data-id="5">
                    <img src="CartIcon.png" alt="Add to cart" class="btn-icon" />
                </button>
            </div>
                
          </div>
        </div>
  </main>

  <footer class="footer-flex">
    <!-- LEFT SIDE: Currency Selector -->
    <div class="footer-left">
      <div class="custom-select-wrapper">
        <label for="currencySelector" class="currency-label">Currency</label>
        <div class="custom-select" id="customSelect">
          <div class="selected-option" id="selectedOption">GBP (£)</div>
          <span class="arrow" id="dropdownArrow">v</span>
          <ul class="options" id="optionsList">
            <li data-value="GBP">GBP (£)</li>
            <li data-value="USD">USD ($)</li>
            <li data-value="EUR">EUR (€)</li>
          </ul>
        </div>
      </div>
    </div>
    
    <!-- RIGHT SIDE: Copy & Links -->
    <div class="footer-right">
      <p class="footer-copy">© 2025 DEADSTOCKBLVD</p>
      <div class="footer-links">
        <a href="#" class="policy-link" data-modal-target="modal-terms">T&Cs</a>
        <a href="#" class="policy-link" data-modal-target="modal-policy">Privacy Policy</a>
        <a href="#" class="policy-link" data-modal-target="modal-service">Terms of Service</a>
        <a href="#" class="policy-link" data-modal-target="modal-refund">Refund Policy</a>
        <a href="Contact.html" class="policy-link">Contact Information</a>
      </div>
    </div>
  </footer>

    <!-- Mobile Slide-in Cart Drawer -->
    <div id="mobileCartDrawer">
        <div id="mobileCartHeader">
            <h3>Your Cart</h3>
            <button id="closeCartDrawer">&times;</button>
        </div>
        <div id="mobileCartItems"></div>
        <div id="mobileCartFooter">
            <div class="footer-totals">
                <p>Subtotal: <span id="drawerCartSubtotal">0.00</span></p>
            </div>
            <button id="drawerCheckoutBtn" class="checkout-bar">Checkout</button>
        </div>
    </div>
    <!-- 🔴 New: Backdrop for closing drawer on outside click -->
    <div id="cartBackdrop" class="cart-backdrop"></div>


  <!-- ✅ Policy Modal -->
  <div id="modal-policy" class="modal" role="dialog" aria-modal="true" aria-labelledby="policy-title">
    <div class="modal-content">
      <span class="close" role="button" aria-label="Close Modal">&times;</span>
      <h3 id="policy-title">Terms & Conditions</h3>
      <p>Your policy content goes here.</p>
    </div>
  </div>
  
  <!-- ✅ Refund Policy Modal -->
  <div id="modal-refund" class="modal" role="dialog" aria-modal="true" aria-labelledby="refund-title">
    <div class="modal-content">
      <span class="close" role="button" aria-label="Close Modal">&times;</span>
      <h3 id="refund-title">Refund Policy</h3>
      <p>No refunds. All sales are final.</p>
    </div>
  </div>
  
  <!-- ✅ Terms & Conditions Modal -->
  <div id="modal-terms" class="modal" role="dialog" aria-modal="true" aria-labelledby="terms-title">
    <div class="modal-content">
      <span class="close" role="button" aria-label="Close Modal">&times;</span>
      <h3 id="terms-title">Terms & Conditions</h3>
      <p>By using this site, you agree to...</p>
    </div>
  </div>
  
  <!-- ✅ Terms of Service Modal -->
  <div id="modal-service" class="modal" role="dialog" aria-modal="true" aria-labelledby="service-title">
    <div class="modal-content">
      <span class="close" role="button" aria-label="Close Modal">&times;</span>
      <h3 id="service-title">Terms of Service</h3>
      <p>Your Terms of Service content goes here.</p>
    </div>
  </div>

    <!-- Modal -->
  <div class="overlay" id="modalOverlay">
    <div class="popup" id="popupBox">
      <span class="close-btn" id="closeBtn">&times;</span>
      <h2>Disclaimer</h2>
      <p>
        If you have ANY concerns, please reach out prior to ordering. 
        Ensure your size is accurate. Violations of these terms may 
        result in refusal of service or account bans.
        <br></br>
        By placing an order, you agree to DeadstockBlvd’s terms including return policies,
        privacy rights, and payment rules. Read carefully before continuing.
        <br></br>
        <h4>OVERVIEW</h4>
        <br></br>
        This website is operated by [Your Site Name]. 
        Throughout the site, the terms “we”, “us” and “our” refer to [Your Site Name].
        [Your Site Name] offers this website, including all information, 
        tools and services available from this site to you, the user, 
        conditioned upon your acceptance of all terms, conditions, policies and notices stated here.
        <br></br>
        By visiting our site and/or purchasing access to a product link or service, 
        you engage in our “Service” and agree to be bound by the following terms and conditions
        (“Terms of Service”, “Terms”), including those additional terms and policies referenced herein 
        and/or available by hyperlink. These Terms apply to all users of the site, 
        including without limitation users who are browsers, purchasers, contributors of content, or affiliates.
        <br></br>
        Please read these Terms of Service carefully before accessing or using our website.
        If you do not agree to all the terms and conditions, then you may not access the site or use any services. 
        If these Terms of Service are considered an offer, acceptance is expressly limited to these Terms.
        <br></br>
        Any new features or tools added to the current site shall also be subject to the Terms of Service. 
        You can review the most current version at any time on this page. We reserve the right to update, 
        change or replace any part of these Terms by posting updates on the website. 
        Your continued use of the site constitutes acceptance of those changes.
        <br></br>
        All second-hand items are final sale — no refunds, 
        no exchanges. This site acts solely as a third-party 
        sourcing platform for specific items.
        <br><br>
        We ("the brand") do not assume responsibility for your
        failure to review the clearly stated policies. 
        By using this site, you acknowledge and accept these terms.
        <br><br>
        <h4>SECTION 1 - USE OF THE SITE</h4>
        <br></br>
        By agreeing to these Terms, you confirm that you are at least the age of majority in your jurisdiction,
        or that you are the age of majority and have given consent for any minor dependents to use this site.
        <br></br>
        You may not use our content or products for any illegal or unauthorized purpose, nor may you,
        in the use of the Service, violate any laws in your jurisdiction 
        (including but not limited to copyright or data protection laws).
        <br></br>
        A breach or violation of any of the Terms will result in an immediate termination of your Services.
        <br></br>
        <h4>SECTION 2 - NATURE OF PRODUCTS</h4>
        <br></br>
        [Your Site Name] provides users with access to curated product links, 
        exclusive or early access links, affiliate links, or other digital information relating to third-party products. 
        We do not own or sell the physical products linked to, and we are not responsible for the final delivery, 
        performance, or condition of any third-party items.
        
        Use of our service grants you access to information or links and does not guarantee stock availability, 
        pricing accuracy, or purchase success on third-party platforms.
        
        <h4>SECTION 3 - BILLING AND ACCESS</h4>
        <br>
        You agree to provide accurate, current, and complete information for all purchases made via our site.
        <br>
        We reserve the right to limit, refuse or cancel access if we suspect you have provided false information, 
        violated our terms, or engaged in misuse of the Service.
        <br>
        Some services may be subscription-based or one-time purchases. All sales are final unless otherwise stated.
        <br></br>
        
        <h4>SECTION 4 - MODIFICATIONS TO THE SERVICE</h4>
        <br>
        We reserve the right to modify or discontinue the Service (or any part of it) at any time without notice.
        <br>
        We are not liable to you or any third-party for any modification, price change, suspension, or discontinuance of the Service.
        <br>
        <br>
        <h4>SECTION 5 - THIRD-PARTY PRODUCTS & LINKS</h4>
        <br>
        Our platform is built on external product links and references to third-party websites. 
        We do not control, manage, or guarantee the accuracy, availability, or safety of those external platforms or products.
        <br>
        Any purchase, dispute, return, or warranty issue regarding a product linked from our site must be handled directly with
        the third-party seller. We are not responsible for the outcome of your interaction with external websites.
        <br></br>
        
        <h4>SECTION 6 - ACCURACY, COMPLETENESS, AND ERRORS</h4>
        <br>
        While we aim to keep information up-to-date and accurate, the site may occasionally contain errors, 
        outdated info, or inaccuracies — particularly with product descriptions, pricing, availability, or link functionality.
        <br>
        We reserve the right to correct any errors or cancel access if necessary, without notice.
        <br></br>
        
        <h4>SECTION 7 - PROHIBITED USES</h4>
        <br>
        You are prohibited from using the site or its content:
        <br>
        For unlawful purposes
        <br>
        To violate any laws or regulations
        <br>
        To exploit or mislead users
        <br>
        To scrape or mine data
        <br>
        To interfere with or bypass the functionality or security of the site
        <br>
        To reproduce, sell, or redistribute access to links or digital products without consent
        <br>
        We reserve the right to terminate your access for any misuse of the Service.
        <br></br>
        
        <h4>SECTION 8 - DISCLAIMER OF WARRANTIES; LIMITATION OF LIABILITY</h4>
        <br>
        We do not guarantee that use of the Service will be uninterrupted or error-free. 
        The service is provided “as is” and “as available” without any warranties, express or implied.
        <br>
        We make no guarantees about:
        <br>
        The reliability or accuracy of product links
        <br>
        Third-party product availability
        <br>
        Purchase success from external retailers
        <br>
        Any specific results from using the Service
        <br></br>
        In no case shall [Your Site Name] be liable for any direct, indirect, 
        incidental or consequential damages arising from your use of the Service or reliance on the content provided.
        <br></br>
        
        <h4>SECTION 9 - INDEMNIFICATION</h4>
        <br>
        You agree to indemnify and hold harmless [Your Site Name] and its owners, partners, 
        affiliates, and employees from any claims, liabilities, or damages arising from your use of the Service, 
        your breach of the Terms, or your violation of any rights or laws.
        <br></br>
        
        <h4>SECTION 10 - TERMINATION</h4>
        <br>
        These Terms remain in effect unless and until terminated by either party. 
        You may terminate by discontinuing use of the Service. We may terminate access at any time for any breach,
        suspected misuse, or at our sole discretion.
        <br></br>
        
        <h4>SECTION 11 - GOVERNING LAW</h4>
        <br>
        These Terms and any disputes related to them shall be governed by and construed in accordance with
        the laws of the United Kingdom.
        <br></br>
        
        <h4>SECTION 12 - ENTIRE AGREEMENT</h4>
        <br>
        These Terms constitute the entire agreement between you and [Your Site Name], 
        superseding any prior agreements. Any ambiguities shall not be construed against the drafting party.
        <br></br>
        
        <h4>SECTION 13 - CONTACT INFORMATION</h4>
        <br>
        For questions or concerns regarding these Terms of Service, please contact us at:
        <br>
        
        [Your Site Name]
        Email: [your@email.com]
        Registered Business Address: [Insert if applicable]
      </p>
    </div>
  </div>
  <script>
    window.addEventListener("load", () => {
      const preloader = document.getElementById("preloader");
      if (!preloader) return;
        
      // Short delay to make sure images render properly
      setTimeout(() => {
        preloader.style.opacity = "0";
        setTimeout(() => {
          preloader.style.display = "none";
        }, 500); // fade out transition
      }, 300); // only wait 300ms after load
    });
  </script>

  <script>
    const customSelect = document.getElementById('customSelect');
    const selectedOption = document.getElementById('selectedOption');
    const arrow = document.getElementById('dropdownArrow');
    const optionsList = document.getElementById('optionsList');
    
    let isDropdownOpen = false;
    
    // Toggle dropdown
    customSelect.addEventListener('click', () => {
      isDropdownOpen = !isDropdownOpen;
      optionsList.style.display = isDropdownOpen ? 'block' : 'none';
      arrow.textContent = isDropdownOpen ? '^' : 'v';
    });
    
    // Handle option selection
    optionsList.querySelectorAll('li').forEach(option => {
      option.addEventListener('click', (e) => {
        const value = e.target.dataset.value;
        selectedOption.textContent = e.target.textContent;
        optionsList.style.display = 'none';
        arrow.textContent = 'v';
        isDropdownOpen = false;
        
        // 👉 You can also handle currency switching logic here
        console.log('Currency selected:', value);
      });
    });
    
    // Click outside closes dropdown
    document.addEventListener('click', (e) => {
      if (!customSelect.contains(e.target)) {
        optionsList.style.display = 'none';
        arrow.textContent = 'v';
        isDropdownOpen = false;
      }
    });
  </script>

  <script>   //new here//
    const modalTriggers = document.querySelectorAll('[data-modal-target]');
    const modals = document.querySelectorAll('.modal');
    const closeButtons = document.querySelectorAll('.modal .close');
    
    // Open specific modal
    modalTriggers.forEach(trigger => {
      trigger.addEventListener('click', () => {
        const targetId = trigger.getAttribute('data-modal-target');
        const modal = document.getElementById(targetId);
        if (modal) {
          modal.style.display = 'flex';
          document.body.style.overflow = 'hidden'; // ✅ Prevent background scroll
        }
      });
    });
    
    // Close modal when clicking X
    closeButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const modal = btn.closest('.modal');
        modal.style.display = 'none';
        document.body.style.overflow = ''; // ✅ Re-enable background scroll
      });
    });
    
    // Close when clicking outside modal content
    modals.forEach(modal => {
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.style.display = 'none';
          document.body.style.overflow = ''; // ✅ Re-enable background scroll
        }
      });
    });
  </script>

  <script>
    const readMoreLinks = document.querySelectorAll('.read-more');
    const overlay = document.getElementById('modalOverlay');
    const closeBtn = document.getElementById('closeBtn');
    
    // Open modal for any .read-more clicked
    readMoreLinks.forEach(link => {
      link.addEventListener('click', () => {
        overlay.style.display = 'flex';
      });
    });
  
    // Close when clicking outside the popup
    overlay.addEventListener('click', (e) => {
      if (e.target === overlay) {
        overlay.style.display = 'none';
      }
    });
    
    // Close when clicking the X
    closeBtn.addEventListener('click', () => {
      overlay.style.display = 'none';
    });
  </script>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const addToCartBtn = document.getElementById('addToCartBtn');
      const pfAmount = document.getElementById('pfAmount');
      const pfItemName = document.getElementById('pfItemName');
      
      if (addToCartBtn && pfAmount && pfItemName) {
        // Get product price & name from Add to Cart button data attributes
        const price = addToCartBtn.getAttribute('data-price');
        const name = addToCartBtn.getAttribute('data-name');
        
        // Format price to two decimals (e.g., "35.00")
        const formattedPrice = parseFloat(price).toFixed(2);
      
        // Update PayFast form hidden inputs
        pfAmount.value = formattedPrice;
        pfItemName.value = name;
      }
    });
  </script>

  <!-- ✅ Add this at the bottom, before </body> -->
  <script type="module">
    import {
      setCurrency,
      getCurrency,
      formatPrice
    } from './currency.js';
    
    document.addEventListener('DOMContentLoaded', async () => {
      const addToCartBtn = document.getElementById("addToCartBtn");
      const basePriceGBP = parseFloat(addToCartBtn?.dataset.price || 0);
      const priceEl = document.getElementById("convertedPrice");
      const selector = document.getElementById("currencySelector");
      
      async function updatePriceDisplay() {
        priceEl.innerHTML = await formatPrice(basePriceGBP);
      }
      
      selector.value = getCurrency();
      selector.addEventListener('change', async (e) => {
        setCurrency(e.target.value);
        await updatePriceDisplay();
      });
      
      await updatePriceDisplay();
    });
  </script>

  <script type="module">
    import { formatPrice, getCurrency, setCurrency } from './currency.js';
        
    document.addEventListener('DOMContentLoaded', async () => {
      const priceEls = document.querySelectorAll('.converted-price');
        
      for (let el of priceEls) {
        const gbp = parseFloat(el.dataset.gbp);
        el.innerText = await formatPrice(gbp);
      }
    });
  </script>

  <script type="module" src="search.js"></script>
  <script type="module" src="product.js"></script>
  <script type="module" src="cart.js"></script>
  <script type="module" src="currency.js"></script>
  <script type="module" src="currency-init.js"></script>
</body>
</html>
