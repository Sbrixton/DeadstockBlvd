<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contact</title>
  <link rel="stylesheet" href="base.css">
  <link rel="stylesheet" href="style.css"> 
  <script type="module" src="cart-utils.js"></script>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"/>
  <script src="data.js"></script>
  <script type="module" src="script.js" defer></script>
</head>
<body class="sticky-footer" >
  <div class="page-wrapper">
    <!-- ========== NAVBAR ========== -->
    <header class="navbar">
      <div class="nav-left">
        <a href="index.html" class="logo">
          <img src="DEADSTOCK (3).png" alt="DeadstockBlvd Logo" height="50" />
        </a>
        <div class="nav-wrapper" id="navWrapper">
          <nav id="navbar">
            <i id="close" class="fas fa-times"></i>
            <a href="index.html">Home</a>
            <a href="shop.html">Shop</a>
            <a href="Contact.html" class="active">Contact</a>
          </nav>
        </div>
        <i id="bar" class="fas fa-bars"></i>
      </div>
      <div class="nav-right">
        <button id="searchIcon">
          <img src="SearchIcon.png" alt="Search" class="search-icon" style="height: 30px" />
        </button>
        <div id="cartIcon" class="cart-wrapper" role="button" tabindex="0">
          <img src="CartIcon.png" alt="Cart" class="cart-icon" style="height: 30px" />
          <span id="cart-count">0</span>
        </div>
      </div>
    </header>

    <div id="preloader">
      <div class="loader">Loading...</div>
    </div>
    
    <!-- ✅ Search Bar Container (works for all screen sizes) -->
    <div id="searchBarContainer">
      <!-- 🔍 Input field with clear button -->
      <div class="search-input-wrapper">
        <input
          type="text"
          id="searchInput"
          placeholder="Search products..."
          autocomplete="off"/>
        <button id="clearSearch" aria-label="Clear Search">&times;</button>
      </div>
      
      <!-- ✅ Scrollable area for suggestions + results -->
      <div id="searchScrollableArea">
        <!-- 🔽 Suggestions (autocomplete-style) -->
        <ul id="searchSuggestions" class="search-suggestions"></ul>
        
        <!-- 🔍 Search Results -->
        <div id="searchResultsWrapper">
          <p id="noResultsMessage" style="display: none;">No products found.</p>
          <div id="searchResults">
          </div>
        </div>
      </div>
    </div>
    
    <!-- ✅ Optional: Dimmed overlay (used when input is active) -->
    <div id="searchOverlay"></div>
    
    <!-- ========== MAIN CONTACT CONTENT (placeholder) ========== -->
    <main style="padding: 40px; text-align: center;">
      <h1>Contact Us</h1>
      
      <div id="formSuccessMessage" style="display: none;">
        
        <span style="color: green; font-weight: bold;">
          ✅ Thanks for contacting us. We'll get back to you as soon as possible.
        </span>
      </div>
      <!-- Add your contact form or info here -->
      <section id="contact-form-section" class="section-p1">
        <form 
          id="contactForm" 
          class="contact-form" 
          action="https://formspree.io/f/xblkjged" 
          method="POST">
          <div class="form-row">
            <div class="form-group">
              <label for="name"><span></span></label>
              <input type="text" id="name" name="name" placeholder="Name" required />
            </div>
            
            <div class="form-group">
              <label for="email"><span></span></label>
              <input type="email" id="email" name="email" placeholder="Email" required />
            </div>
          </div>
          
          <div class="form-group full-width">
            <label for="message"><span></span></label>
            <textarea id="message" name="message" rows="6" placeholder="Your Message" required></textarea>
          </div>
          
          <button type="submit" class="btn-submit">Send Message</button>
        </form>
      </section>
      
    </main>
    
    <!-- ========== FOOTER ========== -->
    <footer class="section-p1">
      <div class="col install">
        <p>Secured Payment Gateways</p>
        <img src="Downloads/payments.PNG" alt="Payment Methods">
      </div>
      <div class="copyright">
        <p>© 2025, DeadstockBlvd</p>
      </div>
    </footer>
    
    <!-- Mobile Slide-in Cart Drawer -->
    <div id="mobileCartDrawer">
        <div id="mobileCartHeader">
            <h3>Your Cart</h3>
            <button id="closeCartDrawer">&times;</button>
        </div>
        <div id="mobileCartItems"></div>
        <div id="mobileCartFooter">
            <div class="footer-totals">
                <p>Subtotal: <span id="drawerCartSubtotal">0.00</span></p>
            </div>
            <button id="drawerCheckoutBtn" class="checkout-bar">Checkout</button>
        </div>
    </div>
    
    <script>
      window.addEventListener("load", () => {
        const preloader = document.getElementById("preloader");
        if (!preloader) return;
        
        // Short delay to make sure images render properly
        setTimeout(() => {
          preloader.style.opacity = "0";
          setTimeout(() => {
            preloader.style.display = "none";
          }, 500); // fade out transition
        }, 300); // only wait 300ms after load
      });
    </script>
        
    <script>
      const form = document.getElementById('contactForm');
      const successBox = document.getElementById('formSuccessMessage');
      
      form.addEventListener('submit', async function (e) {
        e.preventDefault();
        
        const formData = new FormData(form);
        
        try {
          const response = await fetch(form.action, {
            method: 'POST',
            body: formData,
            headers: {
              'Accept': 'application/json'
            }
          });
          
          if (response.ok) {
            // ✅ Show success message with icon
            successBox.innerHTML = `
              <div class="icon">✔</div>
              <div>Thanks for contacting us. We'll get back to you as soon as possible.</div>
            `;
            successBox.style.display = 'flex';
            
            // Fade out after 3 seconds
            setTimeout(() => {
              successBox.classList.add('fade-out');
            }, 3000);
            
            // Optionally hide after fading out
            setTimeout(() => {
              successBox.style.display = 'none';
              successBox.classList.remove('fade-out');
            }, 5000);
            
            form.reset(); // Clear the form
          } else {
            alert("Something went wrong. Please try again.");
          }
        } catch (error) {
          alert("Error sending message.");
        }
      });
    </script>
    
    <script>
      window.addEventListener("load", () => {
        const preloader = document.getElementById("preloader");
        if (!preloader) return;
        
        // Short delay to make sure images render properly
        setTimeout(() => {
          preloader.style.opacity = "0";
          setTimeout(() => {
            preloader.style.display = "none";
          }, 500); // fade out transition
        }, 300); // only wait 300ms after load
      });
    </script>
    
    <script>
      const readMoreLinks = document.querySelectorAll('.read-more');
      const overlay = document.getElementById('modalOverlay');
      const closeBtn = document.getElementById('closeBtn');
      
      // Open modal for any .read-more clicked
      readMoreLinks.forEach(link => {
        link.addEventListener('click', () => {
          overlay.style.display = 'flex';
        });
      });
      
      // Close when clicking outside the popup
      overlay.addEventListener('click', (e) => {
        if (e.target === overlay) {
          overlay.style.display = 'none';
        }
      });
      
      // Close when clicking the X
      closeBtn.addEventListener('click', () => {
        overlay.style.display = 'none';
      });
    </script>
    
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const addToCartBtn = document.getElementById('addToCartBtn');
        const pfAmount = document.getElementById('pfAmount');
        const pfItemName = document.getElementById('pfItemName');
        
        if (addToCartBtn && pfAmount && pfItemName) {
          // Get product price & name from Add to Cart button data attributes
          const price = addToCartBtn.getAttribute('data-price');
          const name = addToCartBtn.getAttribute('data-name');
          
          // Format price to two decimals (e.g., "35.00")
          const formattedPrice = parseFloat(price).toFixed(2);
          
          // Update PayFast form hidden inputs
          pfAmount.value = formattedPrice;
          pfItemName.value = name;
        }
      });
    </script>
    
    <!-- ✅ Add this at the bottom, before </body> -->
    <script type="module">
      import {
        setCurrency,
        getCurrency,
        formatPrice
      } from './currency.js';
    
      document.addEventListener('DOMContentLoaded', async () => {
        const addToCartBtn = document.getElementById("addToCartBtn");
        const basePriceGBP = parseFloat(addToCartBtn?.dataset.price || 0);
        const priceEl = document.getElementById("convertedPrice");
        const selector = document.getElementById("currencySelector");
        
        async function updatePriceDisplay() {
          priceEl.innerHTML = await formatPrice(basePriceGBP);
        }
        
        selector.value = getCurrency();
        selector.addEventListener('change', async (e) => {
          setCurrency(e.target.value);
          await updatePriceDisplay();
        });
        
        await updatePriceDisplay();
      });
    </script>
    
    <script type="module">
      import { formatPrice, getCurrency, setCurrency } from './currency.js';
          
      document.addEventListener('DOMContentLoaded', async () => {
        const priceEls = document.querySelectorAll('.converted-price');
          
        for (let el of priceEls) {
          const gbp = parseFloat(el.dataset.gbp);
          el.innerText = await formatPrice(gbp);
        }
      });
    </script>
    <!-- ========== SCRIPTS ========== -->
    <script type="module" src="navbar.js"></script>
    <script type="module" src="search.js"></script>
    <script type="module" src="cart.js"></script>
    <script type="module" src="currency.js"></script>
    <script type="module" src="currency-init.js"></script>
  </div>
</body>
</html>
